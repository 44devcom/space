---
alwaysApply: true
---
# Docker Selenium UI Testing Service

## Purpose

Define a **Selenium-based** UI testing stack using Docker, typically:

- Selenium standalone Chrome / Firefox container
- Separate test runner container (Node / Java / Python)
- Remote WebDriver connection

---

## Inputs

- `serviceName` (default: `ui-tests-selenium`)
- `seleniumServiceName` (default: `selenium`)
- `baseUrl` (default: `http://api:80`)
- `testDir` (default: `tests/ui`)
- `reportsDir` (default: `reports/ui`)
- `language` (e.g. `node`, `python`, `java`)

---

## Generated Files

- `docker/ui/selenium/runner.Dockerfile`
- Selenium service declaration in docker-compose
- Runner service declaration in docker-compose
- Sample tests (e.g. Node or Python)
- `scripts/run-ui-tests-selenium.sh`

---

## Dockerfile Template (Selenium Test Runner, Node Example)

```Dockerfile
# docker/ui/selenium/runner.Dockerfile

FROM node:18-bullseye

WORKDIR /app

COPY package*.json ./
RUN npm install --omit=dev --silent || npm install --silent

COPY tests/ui ./tests/ui

ENV SELENIUM_URL=${SELENIUM_URL:-http://selenium:4444/wd/hub}
ENV BASE_URL=${BASE_URL:-http://api:80}
ENV CI=1

CMD ["npm", "test"]
```

(If using Python or Java, the agent can swap the base image and commands.)

## docker-compose Services Snippet (Selenium)

```yaml
services:
  selenium:
    image: selenium/standalone-chrome:latest
    container_name: selenium
    shm_size: 2g
    networks:
      - default

  ui-tests-selenium:
    build:
      context: .
    # For Node:
      dockerfile: docker/ui/selenium/runner.Dockerfile
    container_name: ui-tests-selenium
    environment:
      SELENIUM_URL: http://selenium:4444/wd/hub
      BASE_URL: ${UI_TEST_BASE_URL:-http://api:80}
    depends_on:
      selenium:
        condition: service_started
      api:
        condition: service_healthy
    networks:
      - default
    volumes:
      - ./tests/ui:/app/tests/ui:ro
      - ./reports/ui:/app/reports/ui
    command: >
      sh -c "npm test"
```

## Sample Node Selenium Test (Generated by Agent)

```js
// tests/ui/example-selenium.test.js
const { Builder, By, until } = require('selenium-webdriver');

const BASE_URL = process.env.BASE_URL || 'http://localhost:3000';
const SELENIUM_URL = process.env.SELENIUM_URL || 'http://selenium:4444/wd/hub';

describe('Selenium UI Smoke Test', () => {
  let driver;

  beforeAll(async () => {
    driver = await new Builder()
      .usingServer(SELENIUM_URL)
      .forBrowser('chrome')
      .build();
  }, 30000);

  afterAll(async () => {
    if (driver) await driver.quit();
  });

  test('homepage loads', async () => {
    await driver.get(BASE_URL);
    await driver.wait(until.titleContains('Car'), 10000);
  }, 30000);
});
```

## Test Runner Script

```bash
# scripts/run-ui-tests-selenium.sh
#!/usr/bin/env bash
set -euo pipefail

docker compose up -d selenium
docker compose run --rm ui-tests-selenium "$@"
docker compose stop selenium
```

## Agent Instructions

For ui-docker with uiTestingTool = selenium:

- Generate Selenium service + runner Dockerfile + compose services.

For ui-tests:

- Generate minimal Selenium test skeleton (Node/Python/Java based on rules).
- Integrate with tests milestone in Plan.
